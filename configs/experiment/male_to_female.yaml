# @package _global_
defaults:
  - override /trainer: gpu
  - override /data: male_to_female_data
  - override /callbacks: schrodinger_images
  - override /logger: default
  - override /model: big_images

project_name: 'male_to_female'
task_name: 'tr'

trainer:
  val_check_interval: 4000
  log_every_n_steps: 40
  max_epochs: 200
  limit_val_batches: 1

data:
  batch_size: 128
  num_workers: 4

model:
  _target_: src.lightning_modules.TRDSB
  max_gamma: 1.0
  min_gamma: 0.1
  num_steps: 100
  T: 1.0
  lr_multiplier: 1.0
  min_init_lr: 0.0
  cache_max_size: 10
  cache_num_iters: 25
  max_iterations: [350000]
  patience: 5
  initial_forward_sampling: "ornstein_0"
  max_norm: 1.0

  forward_model:
    sample_size: [32, 32]
    time_embedding_type: 'positional'
    block_out_channels: [128, 192, 256]
    down_block_types: ["DownBlock2D", "AttnDownBlock2D", "AttnDownBlock2D"]
    up_block_types: ["AttnUpBlock2D", "AttnUpBlock2D", "AttnUpBlock2D"]

  backward_model:
    sample_size: [32, 32]
    time_embedding_type: 'positional'
    block_out_channels: [128, 192, 256]
    down_block_types: ["DownBlock2D", "AttnDownBlock2D", "AttnDownBlock2D"]
    up_block_types: ["AttnUpBlock2D", "AttnUpBlock2D", "AttnUpBlock2D"]

  optimizer:
    lr: 1.e-4

  scheduler:
    _target_: torch.optim.lr_scheduler.CosineAnnealingWarmRestarts
    _partial_: True
    T_0: 1000
    T_mult: 1
    eta_min: 1.e-6