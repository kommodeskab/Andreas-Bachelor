# @package _global_
defaults:
  - override /trainer: gpu
  - override /data: mnist_to_emnist
  - override /callbacks: schrodinger_images
  - override /model: big_images
  - override /logger: default

project_name: 'mnist_to_emnist'
task_name: 'test'
size: 32

trainer:
  val_check_interval: 1000
  log_every_n_steps: 100
  max_epochs: 200
  limit_val_batches: 5

callbacks:
  fid:
    _target_: src.callbacks.CalculateFID
    num_samples: 1000
  
data:
  start_dataset:
    img_size: ${size}
  end_dataset:
    img_size: ${size}
  batch_size: 256
  num_workers: 4

model:
  max_gamma: 1.0
  min_gamma: 0.01
  num_steps: 30
  T: 1.5
  cache_max_size: 50
  cache_num_iters: 30
  max_iterations: 10000
  initial_forward_sampling: "ornstein_0"
  max_norm: 1.0

  forward_model:
    in_channels: 1
    out_channels: 1
    block_out_channels: [32, 64, 128]
  
  backward_model:
    in_channels: 1
    out_channels: 1
    block_out_channels: [32, 64, 128]

  optimizer:
    lr: 1e-4

  scheduler:
    _target_: torch.optim.lr_scheduler.CosineAnnealingWarmRestarts
    _partial_: True
    T_0: 500
    T_mult: 1
    eta_min: 1e-6