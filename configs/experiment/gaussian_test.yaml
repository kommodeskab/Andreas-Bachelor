# @package _global_
defaults:
  - override /trainer: gpu
  - override /data: gaussian_data
  - override /callbacks: gaussian_CB
  - override /model: twod
  - override /logger: default

dim: 64
n_cond: 101

project_name: 'Gaussian test'
task_name: 'dim: 64'

trainer:
  val_check_interval: 500
  log_every_n_steps: 20
  limit_val_batches: 5
  max_epochs: 200

data:
  cache_num_iters: 10
  start_dataset:
    mu: 1
    sigma: 0.5
    dim: ${dim}
  end_dataset:
    dim: ${dim}
    mu: -1
    sigma: 0.5

model:
  _target_: src.lightning_modules.FRDSB
  forward_model:
    n_cond: 101
    dim_in: ${dim}
    dim_out: ${dim}
    dim_hidden: 128
    num_layers: 3

  backward_model:
    n_cond: 101
    dim_in: ${dim}
    dim_out: ${dim}
    dim_hidden: 128
    num_layers: 3

  max_gamma: 1.0
  min_gamma: 0.01
  num_steps: 100
  T: 1.0
  lr_multiplier: 1.0
  cache_max_size: 50
  max_iterations: 4000
  min_iterations: 1000
  max_norm: 1.0
  initial_forward_sampling: "ornstein_0"

  optimizer:
    _target_: torch.optim.AdamW
    _partial_: True
    lr: 1e-3

  scheduler:
    _target_: torch.optim.lr_scheduler.ReduceLROnPlateau
    _partial_: True
    mode: 'min'
    factor: 0.5
    patience: 3